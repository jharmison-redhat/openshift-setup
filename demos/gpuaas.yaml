---
namespaces:
  - name: project1
    labels:
      opendatahub.io/dashboard: "true"
    annotations:
      openshift.io/description: Project for resources for Internal AI Project 1
      openshift.io/display-name: Project 1
  - name: project2
    labels:
      opendatahub.io/dashboard: "true"
    annotations:
      openshift.io/description: Project for resources for Internal AI Project 2
      openshift.io/display-name: Project 2
applications:
  - name: monitoring
  - name: aws-nvidia-gpu-machinesets
    fileprefix: l40s
    rewrite:
      metadata:
        name: machineset-l40s
    values:
      instanceType: g6e.2xlarge
      desiredReplicas: 2
      baseName: worker-l40s
      taints:
        - key: nvidia.com/gpu
          value: l40s
          effect: NoSchedule
      nodeLabels:
        node-role.kubernetes.io/gpu: ""
        jharmison.dev/gpu-type: l40s
  - name: aws-nvidia-gpu-machinesets
    fileprefix: t4
    rewrite:
      metadata:
        name: machineset-t4
    values:
      instanceType: g4dn.2xlarge
      desiredReplicas: 2
      baseName: worker-t4
      taints:
        - key: nvidia.com/gpu
          value: t4
          effect: NoSchedule
      nodeLabels:
        node-role.kubernetes.io/gpu: ""
        jharmison.dev/gpu-type: t4
  - name: nvidia-gpu-enablement
  - name: kueue-operator
  - name: openshift-ai
    values:
      channel: fast
      dataScienceCluster:
        components:
          ray:
            managementState: Managed
          llamastackoperator:
            managementState: Managed
      dashboardConfig:
        disableModelCatalog: false
        disableLMEval: false
        disableFineTuning: false
        disableKueue: false
      acceleratorProfiles:
        - name: l40s
          displayName: NVIDIA L40s
          enabled: true
          identifier: nvidia.com/gpu
          tolerations:
            - effect: NoSchedule
              key: nvidia.com/gpu
              operator: Equals
              value: l40s
        - name: t4
          displayName: NVIDIA T4
          enabled: true
          identifier: nvidia.com/gpu
          tolerations:
            - effect: NoSchedule
              key: nvidia.com/gpu
              operator: Equals
              value: t4
  - name: kueue
    values:
      resourceFlavors:
        - name: default
        - name: l40s
          spec:
            nodeLabels:
              jharmison.dev/gpu-type: l40s
            tolerations:
              - effect: NoSchedule
                key: nvidia.com/gpu
                operator: Equals
                value: l40s
        - name: t4
          spec:
            nodeLabels:
              jharmison.dev/gpu-type: t4
            tolerations:
              - effect: NoSchedule
                key: nvidia.com/gpu
                operator: Equals
                value: t4
      clusterQueues:
        - name: l40s
          resourceGroups:
            - coveredResources: ["cpu", "memory"]
              flavors:
                - name: default
                  resources:
                    - name: cpu
                      nominalQuota: 16
                    - name: memory
                      nominalQuota: 64Gi
            - coveredResources: ["nvidia.com/gpu"]
              flavors:
                - name: l40s
                  resources:
                    - name: nvidia.com/gpu
                      nominalQuota: 2
          localQueues:
            - namespace: project1
        - name: t4
          resourceGroups:
            - coveredResources: ["cpu", "memory"]
              flavors:
                - name: default
                  resources:
                    - name: cpu
                      nominalQuota: 16
                    - name: memory
                      nominalQuota: 64Gi
            - coveredResources: ["nvidia.com/gpu"]
              flavors:
                - name: t4
                  resources:
                    - name: nvidia.com/gpu
                      nominalQuota: 2
          localQueues:
            - namespace: project2
